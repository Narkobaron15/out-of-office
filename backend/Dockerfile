# latest node
FROM node:latest

# Create app directory
WORKDIR /usr/src/app

# Install app dependencies
COPY package*.json ./

RUN npm i --force

# Bundle app source
COPY . .

ENV PORT=8080
ENV NODE_ENV=production
ENV LOG_LEVEL=info
ENV APP_KEY=$APP_KEY
ENV DB_HOST=$DB_HOST
ENV DB_PORT=$DB_PORT
ENV DB_DATABASE=$DB_DATABASE
ENV DB_USER=$DB_USER
ENV DB_PASSWORD=$DB_PASSWORD
ENV SESSION_DRIVER=cookie
ENV TZ=UTC
ENV BUCKET_NAME=$BUCKET_NAME
ENV GCLOUD_PROJECT_ID=$GCLOUD_PROJECT_ID
ENV GCLOUD_TOKEN=$GCLOUD_TOKEN

EXPOSE 8080

CMD [ "node", "ace", "serve" ]
