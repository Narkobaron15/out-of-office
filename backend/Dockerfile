# latest node
FROM node:latest

# Create app directory
WORKDIR /usr/src/app

# Install app dependencies
COPY package*.json ./

RUN npm i

# Bundle app source
COPY . .

ENV PORT=8080
ENV NODE_ENV=production
ENV LOG_LEVEL=info
ENV APP_KEY=$_APP_KEY
ENV DB_HOST=$_DB_HOST
ENV DB_PORT=$_DB_PORT
ENV DB_DATABASE=$_DB_DATABASE
ENV DB_USER=$_DB_USER
ENV DB_PASSWORD=$_DB_PASSWORD
ENV SESSION_DRIVER=cookie
ENV TZ=UTC
ENV BUCKET_NAME=$_BUCKET_NAME
ENV GCLOUD_PROJECT_ID=$_GCLOUD_PROJECT_ID
ENV GCLOUD_TOKEN=$_GCLOUD_TOKEN

EXPOSE 8080

CMD [ "node", "ace", "serve" ]
